<!DOCTYPE html>
<html>
  <head>
    <meta name="description" content="">
    <meta name="author" content="Thomas Brace">

    <title>Contact Book</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

      <div id="app">
      </div>

      <script src="https://fb.me/react-15.0.0.js"></script>
      <script src="https://fb.me/react-dom-15.0.0.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
      <link rel="stylesheet" type="text/css" href="style.css">

      <script type="text/babel">

            class AppContainer extends React.Component { //parent Component
              constructor() {
                super();

                this.state = {
                  contactsList: [
                    {id:1, name: 'Tom Brace', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''},
                    {id:2, name: 'Ruth Brace', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''},
                    {id:3, name: 'Burt Lancaster', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''},
                    {id:4, name: 'Emily Brace', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''},
                    {id:5, name: 'Harry Brace', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''},
                    {id:6, name: 'John Smith', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''},
                    {id:7, name: 'Dave Johnson', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''}
                  ],
                  selectedContact: {id:1, name: 'Tom Brace', phone: '0123456789', address:'118 Shiplane, farnborough, gu148bh', notes: 'sdfdsfasdfasdf asdf as df asdf  sadf a sdfasdf', Quote:''}
                }
              }

              render(){
                return(
                  <div className="container-fluid">
                    <div className="row">
                      <div id="sidebar" className="col-xs-12 col-md-3 sidebar">
                        <ContactNav
                          selectContact={this.updateContact} //this is not working
                          contactsList={this.state.contactsList}
                        />
                      </div>
                      <div id="content" className="col-xs-12 col-md-9 main">
                        <Content
                          selectedContact={this.state.selectedContact}
                        />
                      </div>
                    </div>
                  </div>
                );
              };

              updateContact(selectedObj){
                console.log("AppContainer :"+selectedObj);
                // this.setState({
                //   selectedContact: selectedObj  //this is not working
                // });
              }
            }

            class ContactNav extends React.Component { //child of AppContainer

              render() {
                const contacts = this._getContacts() || [];
                return(
                  <div>
                    <div className="input-group">
                      <input type="text" className="form-control" placeholder="Search for..." />
                      <span className="input-group-btn">
                        <button className="btn btn-default" type="button">Go!</button>
                      </span>
                    </div>
                    <ul className="nav nav-sidebar">
                      {contacts}
                    </ul>
                  </div>
                );
              }

              selectContact(selectedObj){
                console.log("ContactNav :"+selectedObj);
                this.props.updateContact(selectedObj)
              }

              _getContacts() {
                return this.props.contactsList.map((i) => {
                  return (
                    <Contact
                      name={i.name}
                      phone={i.phone}
                      key={i.id}
                      selectContact={this.selectContact}
                    />
                  );
                });
              }
            }

            class Contact extends React.Component { //child of ContactNav

              _handleClick(name){
                let selectedObj = this.props.name
                console.log("Contact :"+selectedObj);

                this.props.selectContact(selectedObj)
              }

              render() {
                return(
                  <li>
                    <a href="#" onClick={this._handleClick.bind(this)} >
                      {this.props.name}
                    </a>
                  </li>
                )
              }
            }

            class Content extends React.Component { //child of AppContainer
              render() {
                return(
                  <div>
                    <h1 className="page-header">{this.props.selectedContact.name}</h1>
                    <h3 className="sub-header">{this.props.selectedContact.phone}</h3>
                    <h6 className="sub-header">{this.props.selectedContact.address}</h6>
                    <h6 className="sub-header">{this.props.selectedContact.notes}</h6>
                  </div>
                );
              }
            }


            ReactDOM.render(
              <AppContainer />, document.getElementById('app')
            );
      </script>
   </body>
</html>
